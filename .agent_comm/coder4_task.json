{
  "agent_id": "coder4",
  "task_id": "task_2",
  "files": [
    {
      "name": "config.py",
      "purpose": "Agent and environment configuration",
      "priority": "high"
    },
    {
      "name": "requirements.txt",
      "purpose": "Python dependencies",
      "priority": "high"
    }
  ],
  "project_info": {
    "project_name": "enhanced_cs.SY_2508.15649v1_A_Central_Chilled_Water_Plant_Model_for_Designing_",
    "project_type": "agent",
    "description": "Enhanced AI project based on cs.SY_2508.15649v1_A-Central-Chilled-Water-Plant-Model-for-Designing- with content analysis. Detected project type: agent (confidence score: 11 matches).",
    "key_algorithms": [
      "Ment",
      "Original",
      "Shows",
      "Machine",
      "Modular",
      "Themathematical",
      "Open-Source",
      "Complex",
      "Learning",
      "Loading"
    ],
    "main_libraries": [
      "torch",
      "numpy",
      "pandas"
    ]
  },
  "paper_content": "PDF: cs.SY_2508.15649v1_A-Central-Chilled-Water-Plant-Model-for-Designing-.pdf\nChunk: 1/1\n==================================================\n\n--- Page 1 ---\n1\nA Central Chilled Water Plant Model for\nDesigning Learning-Based Controllers\nZhong Guo\u2217and Prabir Barooah\u2020\n\u2217University of Florida\n\u2020Indian Institute of Technology, Guwahati\nAbstract \u2014We describe a framework of modeling a central\nchilled water plant (CCWP) that consists of an aggregate cooling\ncoil, a number of heterogeneous chillers and cooling towers,\nand a chilled water-based thermal energy storage system.\nWe improve upon existing component models from the open\nliterature using a constrained optimization-based framework\nto ensure that the models respect capacities of all the heat\nexchangers (cooling coils, chillers, and cooling towers) irrespec-\ntive of the inputs provided. As a result, the proposed model\nhas a wider range of validity compared to existing models; the\nlatter can produce highly erroneous outputs when inputs are\nnot within normal operating range. This feature is essential\nfor training learning-based controllers that can choose inputs\nbeyond normal operating conditions and is lacking in currently\navailable models. The overall plant model is implemented in\nMatlab and is made publicly available. Simulation of a CCWP\nwith closed loop control is provided as an illustration.\nNOMENCLATURE\nVariables\nP Electric Power Consumption (kW)\nS Fraction of Water in TES\nT Temperature (Celsius)\n\u02d9m Flowrate (kg/sec)\n\u02d9q Heat Exchange Rate (kW)\nSuperscripts\ncc Cooling Coil\nch Chiller\nchw Chilled Water\nchwp Chilled Water Pump\nchwr Chilled Water Return\nchws Chilled Water Supply\ncd Chiller Condenser\nct Cooling Tower\ncw Cooling Water\ncwp Cooling Water Pump\ncwr Cooling Water Return\ncws Cooling Water Supply\nevap Chiller Evaporator\n\u2020Corresponding author, email: pbarooah@iitg.ac.in.\nBoth authors were with the Dept. of Mechanical and Aerospace Engi-\nneering, University of Florida (UF), Gainesville, FL 32601, USA. PB is\ncurrently with the Dept. of Electronics and Electrical Engineering, Indian\nInstitute of Technology, Guwahati, Assam, 781039, India. This work was\nsupported by the National Science Foundation, USA under grants 1934322\n(CMMI) and 2122313 (ECCS) and the Science and Engineering Research\nBoard of India, under grant CRG/2023/008102.oa Outside Air\nrw Chilled Water Loop Return Water\nsw Chilled Water Loop Supply Water\ntes Thermal Energy Storage\ntwc Cold TES sub-tank\ntww Warm TES sub-tank\nL Load\nSubscripts\nk Timestep Index\nLB/UB Lower/Upper Bound\nnom Nominal\nreq Required\nset Setpoint\nOthers\nMtesTotal Water Mass in TES (kg)\nMBL Modelica Buildings Library\nI. I NTRODUCTION\nCentral chilled water plants (CCWPs) consist of chillers,\ncooling towers, and increasingly thermal energy storage\n(TES) systems. They are variously called \u201cchiller plants\u201d,\n\u201ccentral plants\u201d, \u201cdistrict cooling energy plants\u201d, etc. CCWPs\nare widely used in campuses to provide cooling to a cluster of\nbuildings. Optimal control of CCWPs have attracted quite a\nbit of research. Apart from model-based optimal control such\nas MPC [1\u20135], there has recently been considerable interest\nin learning-based control methods, especially reinforcement\nlearning [6\u201310] and extremum-seeking [11, 12].\nLearning-based model-free controllers, such as reinforce-\nment learning (RL) and extremum seeking controllers, need\nto explore the action space to learn the optimal control policy.\nSuch exploration can drive the system outside its normal\nand safe operating conditions. Additionally, training such\na controller for a complex system like a CCWP typically\nrequires a long and costly training phase. Due to the risk\nand cost of learning directly from experiments conducted\non a physical CCWP, these \u201cmodel-free\u201d controllers are\ntypically designed by conducting numerical experiments on\na realistic simulator. There has been substantial work on\nmodeling CCWPs and their components - chillers, cooling\ntowers and TES systems - spanning decades; see [13] and\nreferences therein. Some of the well-established component\nmodels are now incorporated into EnergyPlus [14] and the\nModelica Buildings Library (MBL) [15]. There are worksarXiv:2508.15649v1  [eess.SY]  21 Aug 2025\n\n--- Page 2 ---\n2\nspecifically on modeling CCWPs by combining existing\nequipment models, and controller development is an usual\nmotivation behind these works [16\u201318], as it is in our case.\nHowever, there is currently a lack of easy-to-use open-\nsource models of CCWPs that can be used for training\nlearning-based controllers. One of the main reasons is the\nlimited region of validity of these models. They often produce\npoor predictions when inputs are chosen outside normal\noperation range. For studies with classical control algorithms,\nthis feature is not a serious hurdle since control commands\ncan be chosen to be within normal operating range. However,\nthe situation is quite different in case of an RL controller.\nAn RL controller implicitly learns system constraints by\ngetting poor rewards when its actions lead to constraint\nviolations, such as a lack of adequate cooling to buildings.\nTherefore the simulation model must allow operation outside\nnormal operating conditions and predict poor performance of\nthe plant therein. For example, if a small condenser water\nflow rate is used under a high cooling load condition, the\nmodel must predict that the plant is unable to reject the\nheat from the buildings and the cooling load is not serviced.\nThis is also true for extremum seeking, though to a lesser\ndegree. However, existing models of chillers and cooling\ntowers, and thus of CCWPs composed of them, can predict\nutterly unreasonable outputs when the inputs are outside the\ndesigned operating conditions. We show an example of such\nbehavior - limited region of validity - of a commonly used\nchiller model in Sec. I-A.\nThis paper presents an open-source model for the simu-\nlation of CCWPs that fills the gap mentioned above. The\nschematic of the CCWP for which the proposed model\nis developed is shown in Fig. 1. The components of the\ncentral plant (cooling coil, TES, chiller, and cooling tower)\nare modeled by modifying existing models from the open\nliterature, some of which are already part of EnergyPlus\nand MBL. Our key innovation is to formulate some of the\nequipment models as solutions to constrained optimization\nproblems so that the capacities of all the heat exchangers (the\ncooling coil, chillers, and cooling towers) are respected. As\na result, the proposed CCWP model is able to generate rea-\nsonable outputs when inputs are chosen outside the designed\noperating conditions of the CCWP. Matlab implementation\nis available in https://gitlab.com/pbarooah/ccwp model.\nThe rest of the paper is organized as follows. Section I-A\nprovides evidence of the limited range of validity of an\nexisting chiller model, which is the motivation behind the\npaper. Section I-B summarizes contributions over prior art.\nThe model of each equipment in a CCWP is described in\nSection II. The interconnection of these component models\nto construct the complete model of a CCWP is described\nin Section III. Simulations of an illustrative CCWP model\nare reported in Section IV. The paper concludes with some\ncomments on future work in Section V.\nA. Evidence of limited region of validity\nTheElectric:EIR model of a vapor compression cen-\ntrifugal chiller has been widely used in many studies [19, 20].It is currently available in EnergyPlus [21] and the MBL [15].\nIn this section we present a scenario in which the ex-\nisting Electric:EIR model predictions are dramatically\nincorrect when subjected to inputs that are outside normal\noperating conditions. This failure is the motivation for the\nnew approach to modeling proposed in this paper.\nAnElectric:EIR chiller from the MBL is put\ninto a simulation test environment where all inputs to\na chiller can be varied; see Figure 2(a). The chiller\nhas a rated capacity of 471.2 kW, and is of type\nMcQuay_WSE_471kW_5_89COP_Vanes . When the in-\nputs are at their nominal values, the output - condenser water\nreturn temperature, Tcdwr- is at its nominal value, 35\u25e6C;\nsee Figure 2(b). As the condenser water flow rate \u02d9mcdis\ndecreased, the predicted cooling water return temperature\nincreases. When the cooling water flow rate is reduced to\none tenth of its nominal value, the model predicts that Tcdwr\nis90\u25e6C in steady state; see Figure 2(b). This is clearly\nincorrect; in reality no chiller would exhibit a cooling water\nreturn temperature close to the boiling point. In fact, the\ncondenser return water temperature should be below 48.9\u25e6C\nto prevent damaging water pipes and cooling towers [22].\nThe culprit is the lack of a hard upper bound on the\ncondenser capacity in the Electric:EIR chiller model.\nThe model assumes that the cooling load is transferred to\nthe condenser water by the refrigerant no matter how hot the\nwater stream becomes. In reality, physics imposes saturation :\nif the heat exchange capacity of the equipment is reached,\nthe outlet temperature will not increase further no matter the\ninput is. The existing Electric:EIR model fails to capture\nthis behavior. The underlying chiller model in the MBL is\nthe same as that in EnergyPlus.\nB. Contribution Over Prior Art\nOur first contribution is a novel method to ensure that\nthe state-dependent capacities of all the heat exchangers -\ncooling coils in air handling units, evaporator and condenser\nin chillers, and cooling towers - are all respected at each\nsimulation timestep. While there are research papers that\nhave addressed this issue for some equipment, such as [23],\nthose ideas have not been translated into these open-source\nsimulation tools. The approach we use in this paper to enforce\nhard limits on heat exchanger capacities is to formulate\nthe state propagation problem - to compute next state from\ncurrent states and inputs - as a constrained optimization\nproblem: the actual cooling delivered is one that is as close\nas possible to the cooling demand while staying within the\nheat exchanger capacities. The cooling demand is specified as\nproblem data. Due to the availability of modern optimization\nmodeling tools, specifying and solving the optimization prob-\nlem is straightforward. This approach is inspired partially\nby the iterative computations used in EnergyPlus and MBL\nmodels as well as in the method proposed in [23]. The\nunderlying NLP solver uses an iterative scheme to find an\noptimal solution satisfying the constraints when it exists, but\nusing modern tools for optimization makes it far easier to\n\n--- Page 3 ---\n3\nChilled Water Loop Cooling  loadThermocline\n123Bypass  ValveTESSecondary Pumps123Valve AValve B\nCooling Water Loop \n. . . . \nPrimary Pumps\n. . . Chillers\n  \ud835\udc7b\ud835\udc95\ud835\udc98\ud835\udc98\ud835\udc7a\ud835\udc95\ud835\udc98\ud835\udc98  \ud835\udc7b\ud835\udc95\ud835\udc98\ud835\udc84\ud835\udc7a\ud835\udc95\ud835\udc98\ud835\udc84. . . \nCooling  Towers. . .  Cooling Water Pumps\n\ud835\udc7b\ud835\udc90\ud835\udc82\ud835\udc98\ud835\udc83\u00a0\u02d9\ud835\udc8e\ud835\udc90\ud835\udc82. . . . <latexit sha1_base64=\"T4wcWCwinzdtTA33b1RCOzp/lg4=\">AAACrXicbVFdT9swFHXDPqBjo8AjL9GqSZOYugS6DN4QvPDIpBWQmlLZ7k1rsJPIvplUWfkR/Jq9jp/Bv8FJowlarmTr6H6ce3Quy6UwGASPLW/tzdt379c32h82P37a6mzvXJqs0BwGPJOZvmbUgBQpDFCghOtcA1VMwhW7O6vqV39AG5Glv3Gew0jRaSoSwSm61LizH9cclgqdZI6SyQJKG08ytKq8sbGiONPKsrwsy3GnG/SCOvxVEDagS5q4GG+3bh0TLxSkyCU1ZhgGOY4s1Si4hLIdFwZyyu/oFIYOplSBGdlaUel/cZmJ71S5l6JfZ59PWKqMmSvmOiuVZrlWJV+rDQtMjkZWpHmBkPLFoqSQPmZ+ZZE/ERo4yrkDlGvhtPp8RjXl6Ix8sWWhtB1PIHH+v+aknrLSBr3D6Jtz6ke/+qNoeUIx0E2rc7Hq6R9Xf7DSCDibG/xPW7PWpEfVdcLlW6yCy4NeGPWiX/3uyWlzp3WyRz6TryQkP8kJOScXZEA4uSd/yT/y4H33Bl7s3SxavVYzs0tehDd9Ao3O010=</latexit>\u02d9mbp\n<latexit sha1_base64=\"5oimpULJI1Iyk77GVA4CDdbCUqY=\">AAAC0HicbVFNb9QwEPWGr7J8beHIJWJB4lBFSdlN21tFLxwLYttKm2XlOJOttXYS2Q7tyrIQ1577Q7jCP+HfYCc5tCkj2XqaeTPz9CatGJUqDP8OvHv3Hzx8tPV4+OTps+cvRtsvT2RZCwIzUrJSnKVYAqMFzBRVDM4qAZinDE7T9ZGrn34HIWlZfFWbChYcrwqaU4KVTS1Hb5Nmhia4EtToJCuV5uabTjhW54JrdWGMWY7GYRA24d8FUQfGqIvj5fbg2k4iNYdCEYalnEdhpRYaC0UJAzNMagkVJmu8grmFBeYgF7qRYvx3NpP5eSnsK5TfZG92aMyl3PDUMp1K2a+55P9q81rl+wtNi6pWUJB2UV4zX5W+88bPqACi2MYCTAS1Wn1yjgUmyjp4a0urdJhkkFvjWwsxFVYzgZTVYLRYpUaHwYd4xzo1nbg/jnsdnekdNXScvemOM7Q/mqcgOmLUEicH7u8TMyzWN8lh0NCmTYe7Y9S/2l1wshtEcRB/nowPP3YX3UKv0Rv0HkVoDx2iT+gYzRBBV+gX+o3+eF+8S++H97OleoOu5xW6Fd7VPyK63yM=</latexit>\u02d9mtw\n<latexit sha1_base64=\"YCwV+MFe2YrzlaXI9YDhdmeAYp8=\">AAAC0HicbVFNb9QwEPWGr7J8beHIJWJB4lBFSdlN21tFLxwLYttKm2XlOJOttXYS2Q7tyrIQ1577Q7jCP+HfYCc5tCkj2XqaeTPz9CatGJUqDP8OvHv3Hzx8tPV4+OTps+cvRtsvT2RZCwIzUrJSnKVYAqMFzBRVDM4qAZinDE7T9ZGrn34HIWlZfFWbChYcrwqaU4KVTS1Hb5Nmhia4EtToJCuV5uabTjhW54JrdmGMWY7GYRA24d8FUQfGqIvj5fbg2k4iNYdCEYalnEdhpRYaC0UJAzNMagkVJmu8grmFBeYgF7qRYvx3NpP5eSnsK5TfZG92aMyl3PDUMp1K2a+55P9q81rl+wtNi6pWUJB2UV4zX5W+88bPqACi2MYCTAS1Wn1yjgUmyjp4a0urdJhkkFvjWwsxFVYzgZTVYLRYpUaHwYd4xzo1nbg/jnsdnekdNXScvemOM7Q/mqcgOmLUEicH7u8TMyzWN8lh0NCmTYe7Y9S/2l1wshtEcRB/nowPP3YX3UKv0Rv0HkVoDx2iT+gYzRBBV+gX+o3+eF+8S++H97OleoOu5xW6Fd7VPxBi3xs=</latexit>\u02d9mlw\n<latexit sha1_base64=\"qA+jpPdm1p7ExZwcEjqWf259qaE=\">AAACy3icbVFNT9wwEPWmX7D9WsqRA1FXlXpAUUJ3A72hcuGCBBILSJvtynEmi7V2EtlO0dbNkX/Av+Da/hj+DXaSA4SOZOtp5s3M05u4YFQq37/vOS9evnr9Zm29//bd+w8fBxufzmVeCgITkrNcXMZYAqMZTBRVDC4LAZjHDC7i5aGtX/wCIWmenalVATOOFxlNKcHKpOaD7aieoQkuBK302U8dcayuBNfsWlZVNR8Mfc+vw30OghYMURsn843ebZTkpOSQKcKwlNPAL9RMY6EoYVD1o1JCgckSL2BqYIY5yJmuVVTuF5NJ3DQX5mXKrbOPOzTmUq54bJhWpuzWbPJ/tWmp0v2ZpllRKshIsygtmaty19riJlQAUWxlACaCGq0uucICE2XMe7KlUdqPEkiN5417mAqjmUDMSqi0WMSV9r1v4Y5xajyyfxh2Olq/W6pvOXvjHWtodzSPQbTEoCGOvtu/S0ywWD4m+15NG9cd9o5B92rPwfmuF4ReeDoaHvxoL7qGttBn9BUFaA8doCN0giaIoBt0h/6if86xI53fzp+G6vTank30JJybB+eJ3Kg=</latexit>Tlws<latexit sha1_base64=\"AjTv8/8/cpygg2MAkHjPNFTlbT4=\">AAAC+3icbVFNj9MwEHXD11K+unDkEm2FxGEVJdBmy20FF46LtN1dqSmV40y6Vp3Esh1QZfnO/+CGEDcEV34G/wY7iVbdLCPZepp5b2b0JuWMShWGfwferdt37t7buz988PDR4yej/adnsqoFgTmpWCUuUiyB0RLmiioGF1wALlIG5+nmnauffwIhaVWeqi2HZYHXJc0pwcqmVqODpOmhMwDOabkx+vSjTgqsLkWh2WdhjFmNxmEQNuHfBFEHxqiLk9X+4E+SVaQuoFSEYSkXUcjVUmOhKGFghkktgWOywWtYWFjiAuRSN4sY/4XNZH5eCftK5TfZXYXGhZTbIrVMt6bs11zyf7VFrfLZUtOS1wpK0g7Ka+arynfO+BkVQBTbWoCJoHZXn1xigYmy/l2b0m46TDLIre2tgZgKuzOBlNVgtFinRofB6/jQOjWduD+OewqCuaBX1NBxjqaHztB+6yIF0RGjljh54/4+McNis0sOg4Y2bRR97tXBd/uGs0Ywc0eP+ie+Cc5eBVEcxB8m4+O33fn30HN0gF6iCB2hY/QenaA5IugL+oF+od+e8b5637zvLdUbdJpn6Fp4P/8B0uTuLw==</latexit>Tlwr<latexit sha1_base64=\"vL3A+qWH98QoSTxXUI7p7AxO8Jw=\">AAAC93icbVFNj9MwEHXD11K+unBEQhEVEodV5CxtttxWcOG4SNvdlZpSOc6ka9VxItsBVVZu/A9uCHFD8Af4Gfwb7CRC2ywj2RrNvDfz9CYpOVMa4z8D78bNW7fv7N0d3rv/4OGj0f7jM1VUksKcFryQFwlRwJmAuWaaw0UpgeQJh/Nk89b1zz+CVKwQp3pbwjIna8EyRom2pdXoWdzMMJYBsjanH0ycE30pcyM/1XW9Go1xgJvwrydhl4xRFyer/cHvOC1olYPQlBOlFiEu9dIQqRnlUA/jSkFJ6IasYWFTQXJQS9OIqP0XtpL6WSHtE9pvqlcZVqZS2zyxSKdS9Xuu+L/eotLZbGmYKCsNgraLsor7uvCdK37KJFDNtzYhVDKr1aeXRBKqrXc7W1qlwziFzFremcek1Uwh4RXURq6T2uDgVXRgnZpO3B9FPQYlpWT/oNhhjqYHztD+6PYuDTBsgZPX7u8DUyI3V8E4aGDThtHHApQlE5vduXjWEGbu6GH/xNeTs8MgjILo/WR8/KY7/x56ip6jlyhER+gYvUMnaI4o+oy+o5/ol7f1vnhfvW8t1Bt0nCdoJ7wffwHUduxS</latexit>Trw\n<latexit sha1_base64=\"6iRwiguoFDva0MSNMZ508S2Bnuo=\">AAADL3icbVJNj9MwEHXD11K+unDkElEhgVRFzm6bLbcVXDgu0nZ3paZUjjPpWnWcyHZAVZTfwG/hwBV+BuKCuHLhN2AnEWpTRvJoNPPe+OlpopwzpTH+0XNu3Lx1+87B3f69+w8ePhocPr5QWSEpzGjGM3kVEQWcCZhppjlc5RJIGnG4jNZv7PzyA0jFMnGuNzksUrISLGGUaNNaDl6G9Y6SpCBNU8hMQVWevy/DlOhrmZY0/iirEauq5WCIPVyHu1/4bTFEbZwtD3t/wjijRQpCU06Umvs414uSSM0oh6ofFgpyQtdkBXNTCqNBLcpaT+U+N53YTTJpntBu3d1mGMVKbdLIIK1S1Z3Z5v9m80In00XJRF5oELT5KCm4qzPXGuTGTALVfGMKQiUzWl16TSSh2ti480ujtB/GkBj3Wx+ZNJopRLwwPspVVJXYOw5GxqnJ2OYg6DAoySX7B8UWczIZWUO7q9MIZAv0G+D4lc1dYEzkehuMvRo2qRldLECeM7He3YunNWG6p2D7SBqCBR7ZdGwvxO/ew35xceT5gRe8Gw9PX7e3coCeomfoBfLRCTpFb9EZmiGKPqEv6Cv65nx2vjs/nV8N1Om1nCdoJ5zffwHHjQIh</latexit>Tcdwr,i\n<latexit sha1_base64=\"zG8z/dYEBG6+4881h5pmpsV53Gg=\">AAADM3icbVJNj9MwEHXD11K+unDkElEhcSiRs9tmy20FF46LRHdXakrlOJOuVceJbAepivIr+C0cuMKvQNxWe4XfgJ1EqE0ZKaPRzHvjp5eJcs6Uxvhnz7l1+87dewf3+w8ePnr8ZHD49FxlhaQwoxnP5GVEFHAmYKaZ5nCZSyBpxOEiWr+z84vPIBXLxEe9yWGRkpVgCaNEm9Zy8Dqsd5QkBWmaQmYKqjKMM12m1acyTIm+kmlJ42rEqmo5GGIP1+HuF35bDFEbZ8vD3h+zixYpCE05UWru41wvSiI1oxyqflgoyAldkxXMTSmMDrUoa02V+9J0YjfJpPmEduvuNsOoVmqTRgZpdaruzDb/N5sXOpkuSibyQoOgzUNJwV2dudYkN2YSqOYbUxAqmdHq0isiCdXGyp1XGqX9MIbE/IHWSyaNZgoRL4yXchVVJfaOg5FxajK2OQg6DEpyyf5BscWcTEbW0O7qNALZAv0GOH5jcxcYE7neBmOvhk1qRhcLkOdMrHf34mlNmO4p2D6UhmCBRzYd2wvxu/ewX5wfeX7gBR/Gw9O37a0coOfoBXqFfHSCTtF7dIZmiKIv6Bv6jn44X51fzrVz00CdXst5hnbC+f0XYtkEFA==</latexit>\u02d9mcd,i<latexit sha1_base64=\"XU9SIK/rhzQ1F4abxZlsdUpMYBg=\">AAADa3icbVJLbtswEGWsflL35yS7tguhRoAuAoNKbNndBe2myxSokwCWa1DUyCFMUQJJtTAEXSOn6ba9Qw/RO5SUhMCWPQAHg5k3Mw+PE2acKY3x34OO8+jxk6eHz7rPX7x89bp3dHyt0lxSmNKUp/I2JAo4EzDVTHO4zSSQJORwE64+2/rND5CKpeKbXmcwT8hSsJhRok1q0cNBNaOIeZ5KUBSETiURSyiLIEp1kZTfiyAh+k4mBf9ZluWi18cDXJm7G3hN0EeNXS2OOn0zieaJGU05UWrm4UzPCyI1oxzKbpAryAhdkSXMTChIAmpeVLRK99RkIjdOpXlCu1V2s6MgiVLrJDRIy1K1aza5rzbLdTyZF0xkuQZB60Vxzl2dulYnN2ISqOZrExAqmeHq0jsiCdVGza0tNdNuEEFsPqGWkzBpOFMIeW6UlMuwLPDgwj8zSo2G1vt+q4OSTLIHKLaY8ejMCtoenYQgG6BXA4cfrW8DIyJXm2A8qGCjqqOF3fP9mwvGo70LALKMidU2Fk+qLZMd2iDN1QmZqofhFnhu3YU9K699RLvB9fnA8wf+12H/8lNzYIfoLXqPPiAPjdEl+oKu0BRRdI9+od/oT+efc+K8cd7V0M5B03OCtsw5/Q/uSxTh</latexit>\u02d9mlw\n<latexit sha1_base64=\"O0DGek5FCMRmrkC+mOkRdHHBR3c=\">AAACqnicbVHbTttAEN2YXmh6IcAjL1ajSjygyC7BhTcEL32kFQGqOI121+NkYX3R7hgUrfYX+jV9bf+jf8PacaWSdKRdHc2cmTk6w0opNAbBn4638ez5i5ebr7qv37x9t9Xb3rnSRaU4jHghC3XDqAYpchihQAk3pQKaMQnX7O68rl/fg9KiyC9xUcIko7NcpIJTdKlpbz9uZhiaAc4XGq2JGVXm0n43cUZxrjLDH7S1dtrrB4OgCX8dhC3okzYuptud2zgpeJVBjlxSrcdhUOLEUIWCS7DduNJQUn5HZzB2MHcS9MQ0cqz/wWUSPy2Uezn6TfbfDidY60XGHLOWqVdrdfJ/tXGF6fHEiLysEHK+XJRW0sfCr/3xE6GAo1w4QLkSTqvP51RRjs7FJ1uWSrtxAqkzv7VRKKeZA5MVWKNmzJpgcBgdOKeOhvUfRasdGQPVUp2LNWd4Uv/BGvHvhdqxzdRm6HF9nXD1Fuvg6uMgjAbRl2H/9Ky90ybZI+/JPgnJJ3JKPpMLMiKc/CA/yS/y2zvwvnrfvPGS6nXanl3yJLzkEV8T0gs=</latexit>\u00afTcws\n<latexit sha1_base64=\"6vfl43df5IHeMl1yb2HnCNqaYyY=\">AAADMXicbVJNa9tAEF2rX6n7Eac99iJqCoUGISW24txCe+kxhToJWK5ZrUbO4tVK7K4azKIf0d/SQ6/tz8it9Frob+iuJIotd2CHYea92cdj4oJRqXz/tufcuXvv/oO9h/1Hj5883R8cPLuQeSkITEnOcnEVYwmMcpgqqhhcFQJwFjO4jFfv7PzyMwhJc/5RrQuYZ3jJaUoJVqa1GLyJ6h0aZyBMk4tcQqWjJFc6qz7pKMPqWmSa3FRVtRgMfc+vw90tgrYYojbOFwe9P2YTKTPgijAs5SzwCzXXWChKGFT9qJRQYLLCS5iZkhsVcq5rRZX7ynQSN82FeVy5dXeTYTRLuc5ig7QqZXdmm/+bzUqVTuaa8qJUwEnzUVoyV+WutchNqACi2NoUmAhqtLrkGgtMlDFy65dGaT9KIDX+t05SYTQTiFlpnBTLuNK+dxweGqfGI5vDsMMguBD0H9S3mJPxoTW0uzqLQbTAoAGOTm3uAhMsVptg36th45rRxQIUBeWr7b3+pCZMdhRsnklDsMAjm47thQTde9gtLo68IPTCD6Ph2dv2VvbQC/QSvUYBOkFn6D06R1NE0Bf0DX1HP5yvzq3z0/nVQJ1ey3mOtsL5/RecGgN+</latexit>\u02d9mcw<latexit sha1_base64=\"qj3AiM1SCoPz+JWyJ86LgsGuGTs=\">AAADMnicbVJNj9MwEHXD11I+tgtHLhEVEocqSnbbbLmt4MJxkba7KzWlcpxJ16rjWLYDqqL8CX4LB67wL+CGuCJ+A3YSoTZlpIxGM++Nn14mFowq7fvfe86t23fu3ju433/w8NHjw8HRk0uVF5LAjOQsl9cxVsAoh5mmmsG1kICzmMFVvH5j51cfQCqa8wu9EbDI8IrTlBKsTWs5GEX1jhJnIE2Ty1xBVUYxluVF9b6MMqxvZFaSj7KqquVg6Ht+He5+EbTFELVxvjzq/YmSnBQZcE0YVmoe+EIvSiw1JQyqflQoEJis8QrmpuRGhlqUtaTKfWE6iZvm0nxcu3V3m2FEK7XJYoO0MlV3Zpv/m80LnU4XJeWi0MBJ81BaMFfnrvXITagEotnGFJhIarS65AZLTLRxcueVRmk/SiA1P6C1kkqjmUDMCmOlXMVV6Xsn4cg4NRnbHIYdBsFC0n9Q32JOJyNraHd1FoNsgUEDHL+yuQtMsFxvg32vhk1qRhcLIATl6929/rQmTPcUbN9JQ7DAY5tO7IUE3XvYLy6PvSD0wnfj4dnr9lYO0DP0HL1EATpFZ+gtOkczRNAn9AV9Rd+cz84P56fzq4E6vZbzFO2E8/svjIsDzw==</latexit>\u00afTcwr\n<latexit sha1_base64=\"6FyHY7S3IJo9Rj365bc1IUGhA9k=\">AAACr3icbVHLTttAFJ24tKWhj1CW3ViNkFi0kU1Tl+4QbFiCRAhSHNKZyXUyMGNbM9etopG/ol/TLXwFf8PYsVBJuNKMju7j3KNzWS6FwSC4b3kvNl6+er35pr319t37D53tjxcmKzSHAc9kpi8ZNSBFCgMUKOEy10AVkzBkN8dVffgbtBFZeo6LHMaKzlKRCE7RpSadr3HNYanQSeYomSygtDGj2p6XVzZWFOdaWT7/Y8qynHS6QS+ow18HYQO6pInTyXbrOp5mvFCQIpfUmFEY5Di2VKPgEsp2XBjIKb+hMxg5mFIFZmxrTaW/6zJT3+lyL0W/zv4/YakyZqGY66x0mtValXyuNiowORhbkeYFQsqXi5JC+pj5lUn+VGjgKBcOUK6F0+rzOdWUo7PyyZal0nY8hcRd4Dkv9YyVNuh9i744p773qz+KVicUA920Ohernv7P6g/WGgHnC4OPtDVrTXpQXSdcvcU6uNjvhVEvOut3D4+aO22ST+Qz2SMh+UEOyQk5JQPCyV/yj9ySOy/0ht6V92vZ6rWamR3yJDzxAIBl1Ck=</latexit>\u00afTchws\nswrw<latexit sha1_base64=\"H+nq6Bso31guoZDWfneNuJqLeEg=\">AAACvnicbVFNbxMxEHWWAiXlI6XHXiyiShyqaBfSpT0gReXSY5GatlI2RLZ3NrFq765sbyGy/Gv4NVzhxL/B+3EgaUey9TTzZubpDS0F1yYM//aCJztPnz3ffdHfe/nq9ZvB/ttrXVSKwZQVolC3lGgQPIep4UbAbamASCrght59qes396A0L/Irsy5hLsky5xlnxPjUYvA5aWbYVBHqbEKJslfum00kMSslLVt9V84d4yQtjJWbBefcYjAMR2ET+CGIOjBEXVwu9nvcj2KVhNwwQbSeRWFp5pYow5kA108qDSVhd2QJMw9zIkHPbaPR4SOfSXFWKP9yg5vs/x2WSK3XknpmLVNv1+rkY7VZZbLTueV5WRnIWbsoqwQ2Ba5NwylXwIxYe0CY4l4rZiuiCDPe2o0trdJ+kkLmL9J6S7jymhlQUYGzaumNDkcf42Pv1Mm4/uN4u0NSUB3Vu1hzxmf1H24R27N1I08ayrgZGZ7Vx4m2T/EQXH8YRfEo/joeTs67M+2iQ/QOvUcR+oQm6AJdoili6Cf6hX6jP8EkyAIZFC016HU9B2gjgh//AFrF2fg=</latexit>\u00afTchwr,\u02d9mchw\nFig. 1. Configuration of a Central Chilled Water Plant considered in this paper.\n(a) Testing environment for an Electric:EIR chiller in\nDymola.\n0 20 40 60\nTime (min)20406080100o C\nTcdwsTcdwr\nTcdwr(        =   1/2 of nominal) mcdmcd(        =  1/10 of nominal)\nTcdwrmcd(         = nominal)\n(b) Prediction of cooling water return temperatures for various\ncondenser water flow rates.\nFig. 2. Evidence of limited region of validity of the Electric:EIR chiller\nmodel: extremely low condenser water supply flow rate incorrectly predicts\nan extremely high cooling water return temperature.\nformulate and solve the constrained optimization problem\nthan implementing an iterative scheme manually.\nOur second contribution is that a Matlab-based soft-\nware implementation of the proposed model is made\npublicly available (https://gitlab.com/pbarooah/ccwp model).\nThis software can be used by researchers to test and comparemultiple control methods.\nOur proposed model structure is divided into three levels:\nequipment, water loop, and plant. Connecting equipment\nmodels belonging to the same water loop results in the cor-\nresponding water loop model and combining multiple water\nloops leads to the plant model. This modular framework\ngreatly reduces the effort for building a customized CCWP\nmodel. For example, swapping a chiller only changes the\nequipment level program; adding chillers or implementing\nnew pump strategies only changes the water loop level\nprogram.\nA preliminary version of the model developed here was\ndescribed in [8, 24]. The model in [8, 24] was limited to\nhomogeneous chillers and cooling towers, while in this paper\neach cooling tower and each chiller has a distinct sub-model\nso that heterogeneous equipment can be modeled in the pro-\nposed framework. Another major difference is that in [8, 24],\nthe plant model was not modular; in fact both supervisory\ncontroller computation and the plant\u2019s state propagation was\ncast as one single constrained optimization problem. In\ncontrast, each equipment sub-model\u2019s computations in this\nwork is separate, which makes the overall plant model to\nbe modular and also provides a clear separation between\nthe model\u2019s state propagation and supervisory controller\u2019s\ncomputations.\nII. E QUIPMENT MODELS\nWe start with a few preliminaries and then describe the\nmodel of each equipment in a CCWP. There are five major\nequipments in a CCWP: the cooling coil, the thermal energy\nstorage (TES), the chiller(s), the cooling tower(s), and var-\nious water pumps: chilled water pumps at the chillers and\nthe cooling water pumps at the cooling towers. For each\nequipment model, we list the control input u, disturbance\ninput w, and state x. All equipment models are discrete time\ndynamical systems of the form: xk+1=f(xk, uk, wk)and\nyk=g(xk, uk), with kbeing the discrete time index. The\nsampling period is denoted by ts.\n\n--- Page 4 ---\n4\nA. Preliminaries\n1) Variable naming convention: Variables are named with\nthe following convention: the supply temperature is (nomi-\nnally) lower than the return temperature . Since the water\nreturning from one equipment is often supplied to another\nequipment, such as cooling coil to chiller, the words \u201csupply\u201d\nand \u201creturn\u201d can be confusing without providing sufficient\ncontext to indicate whether it is \u201csupplied by\u201d or \u201csupplied\nto\u201d. Providing such meticulous context becomes cumber-\nsome, and requires too many super/sub-scripts. The conven-\ntion we follow here is consistent and straightforward. Note\nthat heating equipment such as boilers are not considered\nhere, which may require a revision of this convention.\nB. Aggregate Cooling Coil Model\nIn the hydronic cooling system considered in Figure 1,\neach building has one or more air handing units (AHUs).\nIn each AHU, there is a cooling coil in which the chilled\nwater supplied from chiller(s) is used to cool and dehumidify\nair before the air is resupplied to buildings\u2019 interior; see\nFig. 3. Since air-side modeling is not a focus of this paper,\nwe propose an aggregate cooling coil model that predicts\nthe aggregate behavior of all the cooling coils combined.\nThe superscript \u201clw\u201d - for \u201cload water\u201d - to denote water\nsupplied to the cooling load (the aggregate of all AHUs) by\nthe aggregate coil. The control input ucc, disturbance wcc,\nand state xccof the model are:\nucc= [Tlws,\u02d9mlw]T, (1)\nxcc=Tlwr, (2)\nwcc= \u02d9qL, (3)\nwhere TlwsandTlwrare temperatures of the chilled water at\ninlet (supply) and outlet (return) of the cooling coil; \u02d9mlwis\nthe flowrate of chilled water through the cooling coil; \u02d9qL\nis the cooling required by the aggregate load, and \u02d9qccis\nthe actual cooling provided by the cooling coil, i.e., heat\nabsorbed from the air stream by the chilled water stream;\nHeat balance across the water stream, with a low-pass filter\nto capture the time constant of the heat exchange, gives us\nTlwr\nk+1=accTlwr\nk+ (1\u2212acc)1\nCpw\u02d9mlw\nk( \u02d9qcc\nk+Cpw\u02d9mlw\nkTlws\nk),\n(4)\nwhere acc=e\u2212Ts/\u03c4is a low pass filter coefficient with \u03c4\nbeing the time constant of the cooling coil, Cpwis the specific\nheat of water, and\n\u02d9qcc\nk= min( \u02d9 qL\nk,\u02d9qcc\nUB,k), (5)\nin which \u02d9qcc\nUB,kis the maximum possible heat exchange rate\nat the cooling coil:\n\u02d9qcc\nUB,k=Cpw\u02d9mlw\nk(Tlwr\nUB\u2212Tlws\nk), (6)\nwhere Tlwr\nUBis the maximum allowable outlet water temper-\nature, which implicitly defines the capacity of the cooling\ncoil for a given chilled water flowrate \u02d9mlw, and \u02d9mlw\nUBis the\nqccWarm air \nin\nTlwrChilled\nwater in (supply)\nChilled\nwater out (return)conditioned air\nout\n.qcc.Tlwsmlw, .Fig. 3. Aggregate load/cooling coil. Model inputs (including disturbance)\nin rectangles and outputs in circle.\nmaximum allowable chilled water flowrate due to cooling coil\npipe size. The inputs need to satisfy the following additional\nconstraints:\nTlws\nk\u2264Tlwr\nUB,0\u2264\u02d9qL\nk,0<\u02d9mlw\nk\u2264\u02d9mlw\nUB, (7)\nwhere the first two constraints prevent heating in the cooling\ncoil and the last constraint prevents division by zero.\nThe equations (4), (5), (6), and (7) constitute the proposed\naggregate cooling coil model. Given the current state and\ninputs (command and disturbance), the next state xcc\nk+1can\nbe computed from them.\nThe model is an abstraction of the action of the local\ncontroller at the cooling coil that tries to maintain the supply\nair temperature at its setpoint as long as the chilled water\nstream can deliver sufficient cooling. When the cooling load\nis higher than the capacity of the cooling coil, the coil will\nonly deliver the maximum possible heat transfer rate, i.e.,\n\u02d9qcc\nk= \u02d9qcc\nUB,k. This way, the model incorporates heat exchanger\nsaturation:\nMultiple cooling coils can be modeled by combining\nmultiple models of the form above. The aggregate Tlwrwill\nbe the weighted average (weighted by flowrate) of the outlet\ntemperatures at each cooling coil. The model above can also\nbe replaced with a more complex model, such as that in [25],\nas long as the same inputs, states, and outputs are included\nin the new model.\nRemark 1. The reason for enforcing heat transfer capacity\nof the cooling coil implicitly via the maximum return tem-\nperature of the \u201cload water\u201d is that, since the cooling coil\nmodel is an aggregate of many coils, the upper bound on\nits heat exchange capacity is the sum of these individual\ncapacities, which requires considerable bookkeeping that is\nprone to error. In contrast, Tlwr\nUBis fairly standard, and is thus\neasy to specify. According to the ASHRAE handbook [26]\nthis temperature is typically maintained at 12\u221215\u25e6C. In the\nsequel, we use this approach for enforcing capacity of chiller\nand cooling tower as well.\nC. Thermal Energy Storage (TES) Model\nThe thermal energy storage system considered here is a\nchilled water tank. The TES is modeled by two virtual sub-\ntanks: warm water tank (superscript \u201ctww\u201d) and cold water\ntank (superscript \u201ctwc\u201d), as shown in Figure 1. This is a\n\n--- Page 5 ---\n5\ncommon modeling approach since a thermocline separates\nthe warm water and cold water in the TES [27]. Associated\nwith each tank are two variables: the temperature of the\nwaters in the sub-tanks: Ttww\nkandTtwc\nk, and the \u201cfractions\u201d of\nwater mass in them: Stww\nkandStwc\nk. The total mass of water\ninside the TES is always kept constant, i.e., Stww\nk+Stwc\nk= 1.\nThe amount of increase in one sub-tank equals to the amount\nof decrease in the other sub-tank. The flow rate of water\ninto the TES is \u02d9mtw\nk. When \u02d9mtw\nk>0, this means that \u02d9mtw\nkts\n(kg) of water at a temperature Tsw(supply water from the\nchillers; see Fig. 1) is charged into the cold water tank at\ntimek(rather, during the time interval [(k\u22121)ts, kts]) and\n\u02d9mtw\nkts(kg) of water at temperature Ttwwhas been discharged\nfrom warm water tank during the same time. When \u02d9mtw\nk<0,\n\u02d9mtw\nkts(kg) of water at temperature Tlwr(return water from\nthe cooling coil) is charged into the warm water tank and\n\u02d9mtw\nkts(kg) of water at a temperature of Ttwchas been\ndischarged from cold water tank. We assume the TES is\nwell insulated and that no mixing occurs between the two\nsub-tanks. Thus, the temperature in each sub-tank is only\neffected by the temperature and flow rate of water coming\ninto and out of the TES. The input utesand state xtesof the\nTES model are:\nutes= [Tsw, Trw,\u02d9mtw]T(8)\nxtes= [Ttwc, Stwc, Ttww, Stww]T, (9)\nMass balance leads to the following equations for the water\nfractions:\nStwc\nk+1=Stwc\nk+\u02d9mtw\nkts\nMtes, (10)\nStww\nk+1=Stww\nk\u2212\u02d9mtw\nkts\nMtes, (11)\nwhere Mtes(kg) is the total water mass in the TES. For the\nwarm water sub-tank, heat balance leads to\nMtes\u0000\nTtww\nk+1Stww\nk+1\u2212Ttww\nkStww\nk\u0001\n=(\n\u2212ts\u02d9mtw\nkTlwr\nk,\u02d9mtw\nk<0\n\u2212ts\u02d9mtw\nkTtww\nk,\u02d9mtw\nk>0.\n(12)\nBy using (11), we can express (12) compactly as:\nTtww\nk+1=Ttww\nk+tsmin( \u02d9mtw\nk,0)\nMtesStww\nk\u2212ts\u02d9mtw\nk\u0010\nTtww\nk\u2212Tlwr\nk\u0011\n.(13)\nA similar derivation for the cold water tank leads to:\nTtwc\nk+1=Ttwc\nk+tsmax( \u02d9mtw\nk,0)\nMtesStwc\nk+ts\u02d9mtw\nk\u0010\nTsw\nk\u2212Ttwc\nk\u0011\n.(14)\nThe following must also hold:\nStw\nLB\u2264Stwc\nk\u2264Stw\nUB\nStw\nLB\u2264Stww\nk\u2264Stw\nUB)\nfor all k (15)\nwhere Stw\nUBandStw\nLBare maximum and minimum water mass\nfractions for each sub-tank. The equations (10), (11), (13),\n(14), and (15) constitute the TES model. Given the current\nstate and input, one can compute the next state from these\nequations.\nEvaporatorTcdws\nTcdwrmcd\nTchwr\nTchwsmchw\nPchqchTchws\nset qcondCondenser\nrefrigerant\nloop\nTo/from \ncooling \ncoilTo/from \ncooling \ntowerFig. 4. Schematic of a water-cooled vapor compression chiller, showing\nvariables used in the model.\nD. Chiller Model\nWe consider water-cooled vapor compression chillers; see\nFig. 4. The refrigerant loop in the chiller transfers heat from\nthe chilled water stream to the cooling water stream, which\nreduces the chilled water temperature from TchwrtoTchws\nand increases the condenser water temperature from Tcdws\ntoTcdwr.\nThe proposed chiller model is modified from\nthe Electric:EIR chiller model in [21]. The\nElectric:EIR chiller model abstracts out the details\nof the refrigerant loop, and assumes that all of the heat\nabsorbed by the chilled water at the chiller evaporator is\ntransferred to the condenser water at the chiller condenser.\nSince it does not limit the condenser capacity, unrealistically\nhigh condenser water return temperature Tcdwrcan\nbe predicted when cooling by the condenser water is\ninadequate, as demonstrated in Section I-A. We modify the\nElectric:EIR chiller model by enforcing saturation of\nthe condenser water outlet temperature at the predetermined\nvalue Tcwr\nUB, which implicitly defines a hard upper bound\non the capacity of the condenser, i.e., \u02d9qcd\nUB. Because of\nthe saturation feature, the proposed model is called the\nElectric:EIR:wSat model.\nA chiller does not have exogenous inputs; the control input\nand state of a chiller are:\nuch= [Tchwr,\u02d9mchw, Tcdws,\u02d9mcd, Tchws\nset]T, (16)\nxch= [Tchws, Tcdwr]T, (17)\nwhere Tchwrand \u02d9mchware the temperature and flowrate of\ninlet chilled water at the evaporator, Tcdwsand \u02d9mcdare the\ntemperature and flowrate of cooling water entering the chiller\ncondenser, Tchws\nset is the setpoint for the temperature Tchws\nof the chilled water at the evaporator outlet, Tcdwris the\ntemperature at the condenser outlet; \u02d9qevapand\u02d9qcdare the rates\nof heat exchanges at the evaporator and the condenser; Pchis\nthe power consumption of the chiller; Tcwr\nUBis the maximum\nallowable condenser outlet water temperature; \u02d9qevap\nnomis the\nnominal chiller (evaporator) capacity and Pch\nnomis the nominal\nchiller power consumption.\nThe chilled water supply temperature Tchws\nk+1(at evaporator)\nis modeled based on heat balance with a first order dynamic\n\n--- Page 6 ---\n6\nbehavior:\nTchws\nk+1=achTchws\nk+ (1\u2212ach)(Tchwr\nk\u2212\u02d9qevap\nk\nCpw\u00b7\u02d9mchw\nk).(18)\nwhere achis the coefficient of a low pass filter used to model\nfirst order response between inlet and outlet temperatures at\nthe evaporator. The cooling provided by evaporator \u02d9qevap\nkis\nnot determined yet, but we know it cannot exceed either its\nupper bound \u02d9qevap\nUB,kor the required cooling power \u02d9qevap\nreq,k:\n0\u2264\u02d9qevap\nk\u2264min{\u02d9qevap\nreq,k,\u02d9qevap\nUB,k}. (19)\nThe required cooling rate \u02d9qevap\nreq,kis determined by the differ-\nence between the chilled water return temperature and the\nchilled water supply setpoint:\n\u02d9qevap\nreq,k=Cpw\u00b7\u02d9mchw\nk\u00b7(Tchwr\nk\u2212Tchws\nset). (20)\nThe upper bound on the evaporator heat exchange rate\ncapacity is:\n\u02d9qevap\nUB,k= \u02d9qevap\nnom\u00b7fCapFunT\nk, (21)\nwhere \u02d9qevap\nnomis the constant nominal capacity of the chiller\n(evaporator); fCapFunT\nkis a capacity modifier function that\ndepends on myriad factors and is usually an empirical\nrelationship that differs from one chiller to another. We take\nthe empirical relationship provided for the Electric:EIR\nchiller in [21]:\nfCapFunT\nk=\u03b11+\u03b12Tchws\nk+\u03b13(Tchws\nk)2+\u03b14Tcdws\nk\n+\u03b15(Tcdws\nk)2+\u03b16Tchws\nkTcdws\nk, (22)\nwhere \u03b11, ..., \u03b1 6\u2019s are empirical parameters. For the chiller\ncondenser, a heat balance leads to the following dynamic\nmodel of the condenser water return temperature Tcdwrwith\nan assumed first order response between the input and the\noutput (with filter coefficient acd):\nTcdwr\nk+1=acdTcdwr\nk+ (1\u2212acd)(Tcdws\nk+\u02d9qcd\nk\nCpw\u00b7\u02d9mcd\nk),(23)\nwhere \u02d9mcd\nkis the flowrate of cooling water through the\ncondenser, and the heat exchange at the condenser \u02d9qcd\nkis:\n\u02d9qcd\nk= \u02d9qevap\nk+\u03b71Pch\nk, (24)\nwhere the second term \u03b71Pch\nkis due to the waste heat pro-\nduced by the electricity consumed by the chiller, mainly the\ncompressor motors. The condenser return water temperature\ncannot be lower than the supply (after picking up heat at the\ncondenser), and it cannot exceed its upper bound:\nTcdws\nk\u2264Tcdwr\nk\u2264Tcdwr\nUB, (25)\nIn the Electric:EIR model from [21], the electric power\nconsumed by the chiller, Pch\nk, is modeled by the following\nempirical relationships:\nPch\nk=Pch\nnom\u00b7fCapFunT\nk\u00b7fEIRFunT\nk \u00b7fEIRFunPLR\nk \u00b7CRk(26)\nwhere fCapFunTis defined in (22), and\nfEIRFunT\nk =\u03b21+\u03b22Tchws\nk+\u03b23(Tchws\nk)2+\u03b24Tcdws\nk\n+\u03b25(Tcdws\nk)2+\u03b26Tchws\nkTcdws\nk, (27)where \u03b2i\u2019s are empirical parameters. The fEIRFunPLR\nk term is\nthe modifier due to the part load ratio:\nfEIRFunPLR\nk =\u03b31+\u03b32PLR k+\u03b33PLR2\nk, (28)\nPLR k= min\b\nmax{\u02d9qevap\nk\n\u02d9qevap\nUB,k,PLR LB},PLR UB\t\n,(29)\nwith coefficients \u03b3i\u2019s. The last term CR in (26) is the cycling\nratio:\nCRk:= min {PLR k\nPLR LB,1.0} (30)\nwhich is the modifier to account for chiller cycling on and\noff under very low load condition, where PLR LBandPLR UB\nare lower and upper bounds for the part load ratio.\nNote that given the current input and state uch\nk, xch\nk, the\nnext state xch\nk+1, namely Tchws\nk+1andTcwr\nk+1, cannot be uniquely\ndetermined from these relationships since \u02d9qevap\nkis not yet\nknown. The intermediate variable \u02d9qevap\nkand the next state\nxch\nk+1will be determined together as follows. The low-\nlevel controllers will try to run the chiller to cool down\nthe chilled water from Tchwr\nk to the setpoint Tchws\nset unless\neither the evaporator reaches its capacity ( \u02d9qevap\nk= \u02d9qevap\nUB,k)\nor the condenser reaches its capacity ( Tcdwr\nk+1 =Tcdwr\nUB).\nThe actions of these low-level controllers - along with the\nassociated physics that enforces heat exchanger capacities -\nare abstracted into the following optimization problem:\nmin\n\u02d9qevap\nk(Tchws\nset,k\u2212Tchws\nk+1)2\ns.t. (18) \u2212(30)(31)\nIn summary, (31) - a nonlinear program (NLP) - is the\nproposed chiller model as its solution determines the next\nstatexch\nk+1= (Tchws\nk+1, Tcdwr\nk+1)from uch\nk, xch\nk.\nAdditionally, the problem data must satisfy\nTchws\nLB\u2264Tchws\nset,k\u2264Tchwr\nk, (32)\nTcws\nk\u2264Tcdwr\nUB, (33)\nwhere (32) ensure \u02d9qevap\nreq,k\u22650and (33) ensures \u02d9qcd\nk\u22650. If\nthe inputs do not satisfy one of the constraints (32)-(33),\nthe chiller\u2019s refrigerant loop will be considered inoperative,\nand chilled water and condenser water will pass through the\nchiller with no heat exchange: Tchws\nk+1=Tchwr\nk andTcdwr\nk+1=\nTcdws\nk.\nThe electrical power consumed by the pumps that circulate\nthe water streams in the chillers is modeled using a black-box\nmodel proposed in [28]:\nPchwp\nk=a1ln(1 + a2\u02d9mchw\nk) +a3\u02d9mchw\nk+a4, (34)\nwhere aiare empirical parameters.\nRemark 2 (Difference between the proposed chiller model\nElectric:EIR:wSat and the original Electric:EIR\nmodel) .The upper bound Tcwr\nUBin equation (25) implicitly\nenforces an upper bound on the heat exchange rate \u02d9qcd\nkat the\ncondenser in equation (23): the condenser water can absorb\nheat up to the predetermined maximum possible, if needed,\nbut not more. How much it will in fact absorb under part\n\n--- Page 7 ---\n7\nload conditions is computed by solving the NLP (31). This\nfeature is not present in the Electric:EIR:wSat model,\nwhich led to the behavior discussed in Section I-A.\na) Numerical verification: For numerical verification,\nwe use a chiller of type Electric:EIR:Chiller\nCarrier 19XR 823kW/6.28COP/Vanes [21], with\n823 kW-thermal rated capacity. Since the main new feature\nin the proposed model is the optimization-based formulation\nto predict capacity saturation and thereby avoid the kind of\nfailures of existing models described in Section I-A, here we\nonly verify this feature.\nFigures 5(a) shows prediction of the steady state condenser\nwater return temperature a function of condenser water\nsupply temperature and flow rate, while the other inputs\nare fixed. We see that when the condenser water flow rate\nbecomes sufficiently small, the proposed model predicts that\nthe return temperature saturates at its upper bound, 40\u25e6C.\nMeaning, the heat exchanger in the condenser has reached\nits maximum capacity and cannot remove any more heat\nfrom the refrigerant loop. As a result, the chilled water\nsupply temperature on the evaporator side becomes quite\nwarm; see Figure 5(b). In contrast, the original model does\nnot have this saturation and thus predicts incorrectly that\ncooling water return temperature may reach 90\u25e6C; cf. Fig. 2.\nThese numerical tests thus verify that the proposed chiller\nmodel indeed extends the region of validity over the existing\nElectric:EIR model.\nFigures 6(b) and 6(a) show the steady-state prediction of\nthe two states variables of the proposed chiller model, both\nshowing heat exchanger capacity saturation at extreme values\nof inputs.\nE. Cooling Tower Model\nWe consider variable speed evaporative cooling towers in\nthis paper; see Fig. 7. The inputs and state of the cooling\ntower model are:\nuct= [Tcwr,\u02d9mcw,\u02d9moa]T, (35)\nwct=Toawb, (36)\nxct=Tcws, (37)\nwhere Tcws, Tcwrare the temperatures of the cooling water\nsupply (from the cooling tower to the chiller condensers)\nand cooling water return (to the cooling tower); see Fig. 1.\nAs in the other equipment, the actual heat exchange in the\ncooling tower will be the smaller of the heat exchange desired\n(decided by a setpoint to a local controller that manipulates\nthe fan speed) and the capacity of the heat exchanger which\nis a function of the OA wet bulb and air flow rate through\nthe tower.\nThe proposed cooling tower model is modified from the\nvariable speed evaporative cooling tower model in Ener-\ngyPlus [21] with the so-called \u201cYorkCalc\u201d correlations. In\nthe sequel, we will call the unmodified model from En-\nergyPlus the YorkCalc model, and proposed model the\nYorkCalc:wSat model, meaning, \u201cwith saturation\u201d. A\n(a)\n(b)\nFig. 5. Prediction of the proposed Electric:EIR:wSat chiller model:\n(top) steady state condenser outlet temperature and (bottom) evaporator\noutlet temperature (vertical axis) as a function of two inputs (horizontal\naxes), while other inputs are held constant ( Tchwr= 12\u25e6C,\u02d9mchw= 31.86\nkg/s). The value of \u02d9mcd\nnomis 47.44 kg/s.\nfew intermediate variables are needed to describe the model.\nDefine the scope temperature Tscoas the difference between\nthe hot cooling water return temperature and the OA wt bulb\ntemperature:\nTsco\nk:=Tcwr\nk\u2212Toawb\nk, (38)\nwhich is a function purely on the inlet conditions ( uctand\nwct). Define also the range temperature Tran, and approach\ntemperature Tappof the cooling tower as:\nTran\nk:=Tcwr\nk\u2212Tcws\nk, (39)\nTapp\nk:=Tcws\nk\u2212Toawb\nk. (40)\nIt follows from (38)-(40) that\nTran\nk+Tapp\nk=Tsco\nk. (41)\nAlso, Tran\u2208[Tran\nLB, Tran\nUB],Tapp\u2208[Tapp\nLB, Tapp\nUB]where the\nlower and upper bounds are known constants for a particular\ncooling tower design. There are three possible scenarios:\n\n--- Page 8 ---\n8\n(a)\n(b)\nFig. 6. The proposed chiller model Electric:EIR:wSat \u2019s predic-\ntion (top) condenser outlet temperature and (bottom) evaporator outlet\ntemperature at steady state (vertical axis) as a function of two inputs\n(horizontal axes), while other inputs are held constant ( \u02d9mchw= 31.86kg/s,\n\u02d9mcd= 47.44kg/s.)\na) Case 1: Tcwr\nk\u2212Toawb\nk< Tran\nLB+Tapp\nLB: The temperature\ndifference between OA (wet bulb) and cooling water return is\nnot adequate to lose heat to the atmosphere. Meaning, water\nvapor cannot evaporate, and no cooling can be provided to\nthe cooling water. Therefore, Tcws\nk+1=Tcwr\nk.\nb) Case 2: Tcwr\nk\u2212Toawb\nk> Tran\nUB+Tapp\nUB: This is the other\nextreme, in which the maximum possible range and approach\nstill cannot satisfy (41). In this case, the range is saturated\nat its maximum: Tcws\nk+1=Tcwr\nk\u2212Tran\nUB.\nc) Case 3: Tcwr\nk\u2212Toawb\nk\u2208[Tran\nLB+Tapp\nLB, Tran\nUB+Tapp\nUB]:\nIn the YorkCalc model, the following empirical relationship\nis used for computing the approach for a given range [21]:\nbTapp(Tran, uct, wct)\n=2X\ni=0,j=0,\u2113=0c(i+1)\u00b7(j+1)\u00b7(k+1)(Toawb)i(Tran)jLGR\u2113(42)\nAir inFillFan\nTcwr mcw\nmoa\nTcwsToawbqctPctFig. 7. Cooling tower flows and their related variables. Inlet and outlet\nwater flow rates are assumed same.\nwhere LGR is the liquid gas ratio :\nLGR k= min{FRwat\nk\nFRair\nk, LGR UB}, (43)\nwhere FRairandFRwatare the fractions of air and water\nflowrates:\nFRwat\nk=\u02d9mcw\nk\n\u02d9mcwnom, FRair\nk=\u02d9moa\nk\n\u02d9moanom(44)\nOur proposal is to compute range and approach temperatures\nby solving the following optimization problem:\nmin\nTran\nk,Tapp\nk(Tapp\nk\u2212bTapp(Tran\nk, uct, wct))2\ns.t.Tran\nLB\u2264Tran\nk\u2264Tran\nUB,\n(41):Tran\nk+Tapp\nk=Tsco\nk,\nTapp\nLB\u2264Tapp\nk\u2264Tapp\nUB.(45)\nThat is, we use the empirical relation (42) as an approxi-\nmation. Once the range temperature Tran\nkis computed by\nsolving the NLP (45), the cooling water supply temperature\nTcws\nk+1is determined from:\nTcws\nk+1=actTcws\nk+ (1\u2212act)(Tcwr\nk\u2212Tran\nk) (46)\nwhere actis a low pass filter coefficient to model a first\norder response between inlet and outlet temperatures in the\nheat exchanger. The heat exchanged from cooling water to\nthe ambient in the cooling tower is:\n\u02d9qct\nk=Cpw\u02d9mcw\nk(Tcwr\nk\u2212Tcws\nk) (47)\nThe electrical power consumption by the fan motors at the\ncooling tower is modeled using cubic fan law [21]:\nPct\nk=Pct\nnom\u00b7(FRair\nk)3. (48)\nThe electrical power consumption by the water pumps that\ncirculate the cooling water is modeled using a black-box\nmodel proposed in [28]:\nPcwp\nk=\u03b31ln(1 + \u03b32\u02d9mcw\nk) +\u03b33\u02d9mcw\nk+\u03b34. (49)\nwhere \u03b3i\u2019s are empirical parameters.\n\n--- Page 9 ---\n9\nRemark 3 (Difference between YorkCalc model in En-\nergyPlus and MBL and the proposed YorkCalc:wSat\nmodel) .The NLP (45) ensures that when the prediction from\nthe YorkCalc correlations are infeasible (such as when bTapp\nis negative), range and approach temperatures are still within\npre-specified bounds.\nd) Numerical Verification: A tower of YorkCalc type\nwith 47.44 kg/s nominal chiller condenser water flow rate\nis chosen. The other nominal values are return water tem-\nperature: 35\u25e6C, supply water temperature 29.44\u25e6C, and OA\nwet bulb temperature: 25.5\u25e6C [29, Sec. 40.17]. Thus, the\nnominal approach and range are 3.88\u25e6C and 5.55\u25e6C. We take\nTran\nLB= 2.2\u25e6C, meaning no cooling takes place if the range\ntemperature is below 2.2\u25e6C. Figure 8 show the prediction\nof the steady state Tcwsfor varying values of the air and\nwater flow rate fractions, while Toawb\nk, Tcwr\nkare held fixed at\n25.5\u25e6C and 35\u25e6C. We see from the figure that when the OA\nflow rate is really low and the cooling water flow rate is high,\nthe proposed model correctly predicts that the cooling tower\nwould not be able to provide sufficient cooling and that the\nreturn water from the cooling tower would be at the same\ntemperate as that of the water supplied to it ( 35\u25e6C).\nFig. 8. Cooling tower model prediction: Tcws\n\u221eas a function of the two mass\nflow rates while other inputs are held constant.\nIII. C ENTRAL CHILLED WATER PLANT MODEL\nThe widely deployed primary-secondary pumping strategy\nis considered in our CCWP model [30]. Two subsystems\n\u2014 chilled water loop and cooling water loop \u2014 are first\nconstructed by interconnecting equipments in these water\nloops, whose models were described in Section II. The\ninterconnection of the two water loops leads to the full\nCCWP model.\nSince there are multiple chillers and cooling towers in the\nCCWP, the letter iis used as the index for each chiller and\ncooling tower. On/off status of an individual equipment is\ndenoted by the symbol 1. For instance, 1ch,i= 1 if chiller i\nis \u201con\u201d and 0 if \u201coff; similarly 1ct,iis used to denote on/off\nstatus of the i-th cooling tower. A variable without an index\nis the sum of those with indices. For example, \u02d9mchw,1is theflowrate of chilled water through chiller 1, whereas \u02d9mchwis\nthe total chilled water flowrate through all the \u201con\u201d chillers.\nA. Chilled water loop\nThe chilled water loop (see Fig. 1 consists of four types\nof equipment: an aggregate cooling coil, a TES, chillers, and\nchilled water pumps. The exogenous inputs and states of all\nthe constituent component models form those of the chilled\nwater loop. However, due to the interconnected nature of the\nsystem the output of an equipment, or the combination of\nthe outputs of multiple equipments, can become the input\nto another equipment in this loop. So some of the inputs\nto component models become internal variables - that we\nretain as outputs - but do not count as external inputs/control\ncommands. The commanded inputs to the chilled water loop\nare\nuchw= [ \u02d9mlw,\u02d9mtw, Tchws\nset,\u02d9mchws,i, 1ch,i,\u02d9mcd,i], i= 1, . . . , nch.\n(50)\nTo fully describe the interconnected CCWP model the fol-\nlowing variables are needed that are considered as outputs\nsince they are functions of the states and inputs:\nychw= [Tsw, Trw, Tchwr,\u00afTchws,\u02d9msw,\u02d9mbp,\u02d9mchw,\n\u02d9mcd,\u02d9qcc,\u02d9qevap,\u02d9qcd, Pch, Pchwp]. (51)\nTo explain the components of ychw, first note that the\nflowrates, heat exchange rates, and power consumptions\nare the sum of corresponding terms from each individual\nequipment. Using the terminology described at the beginning\nof the section, we get\n\u02d9qevap\nk=nchX\ni=1\u02d9qevap,i\nk, \u02d9qcd\nk=nchX\ni=1\u02d9qcd,i\nk, (52)\nPch\nk=nchX\ni=1Pch,i\nk, Pchwp\nk=nchX\ni=1Pchwp,i\nk, (53)\nwhere \u02d9qevap,i\nk,\u02d9qcd,i\nk, Pch,i\nk, Pchwp,i\nkare defined in (31),(24),\n(26), and (34).\nIn a primary-secondary pumping system, the water\nflowrate through each \u201con\u201d chiller is maintained at its nomi-\nnal value, \u02d9mchw,i\nnom. As a result, the total chilled water flowrate\n(\u02d9mchw\nk) may be more than what is required by loads and\nTES, which is the supply water flowrate \u02d9msw\nk. See the points\nmarked \u201csw\u201d and \u201crw\u201d for \u201csupply water\u201d and \u201creturn water\u201d\nin Fig. 1. A one-way bypass valve thus routes the redundant\nchilled water ( \u02d9mbp\nk) from chiller outlet directly to the chiller\ninlet. We thus obtain the following\n\u02d9mchw\nk=nchX\ni=11ch,i\nk\u02d9mchw,i\nnom, \u02d9mbp\nk= \u02d9mchw\nk\u2212\u02d9msw, (54)\n\u02d9msw\nk= \u02d9mlw\nk+ \u02d9mtw\nk, \u02d9mrw= \u02d9msw. (55)\nThe load water supplied to the cooling coil could be the\nmixture of chilled waters from the chillers or chilled water\nfrom the TES or a mixture of the two, depending on the\n\n--- Page 10 ---\n10\ncommands to valve \u201cA\u201d in Fig. 1. The return water could be\nthe water leaving the cooling coil or the TES or a mixture\nof the two, depending on the commands to valve \u201cB\u201d in\nFig. 1. Chilled water return is a mixture of return water and\nbypass water. The above relationships are summarized below,\nwherePnch\ni=11ch,i\u0338= 0 means at least one chiller is on, andPnch\ni=1 1ch,i= 0 means all chillers are off:\nTlws\nk=\uf8f1\n\uf8f2\n\uf8f3Tsw\nk+min( \u02d9mtw\nk,0)\n\u02d9mlw\nk\u0010\nTsw\nk\u2212Ttwc\nk\u0011\n,Pnch\ni=11ch,i\u0338= 0,\nTtwc\nk,Pnch\ni=11ch,i= 0,\n(56)\nTrw\nk=\uf8f1\n\uf8f2\n\uf8f3Tlwr\nk+max( \u02d9mtw\nk,0)\n\u02d9msw\nk\u0010\nTtww\nk\u2212Tlwr\nk\u0011\n,Pnch\ni=11ch,i\u0338= 0,\nTtww\nk,Pnch\ni=1 1ch,i= 0,\n(57)\n\u00afTchwr\nk=\uf8f1\n\uf8f2\n\uf8f3Trw\nk+\u02d9mbp\nk\n\u02d9mchw\nk(\u00afTchws\nk\u2212Trw\nk),Pnch\ni=11ch,i\u0338= 0\nTrw\nk,Pnch\ni=11ch,i= 0,\n(58)\nwhere the plantwide chilled water supply temperature, de-\nnoted by \u00afTchws, is the temperature of the chilled water\nstreams from all chillers after mixing. It is a weighted average\nof the chilled water supply temperatures of all active chillers:\n\u00afTchws\nk=\uf8f1\n\uf8f2\n\uf8f31\n\u02d9mchw\nkPnch\ni=11ch,iTchws,i\nk\u02d9mchw,i\nk,Pnch\ni=11ch,i\u0338= 0,\nTchwr\nk,Pnch\ni=11ch,i= 0,\n(59)\nFrom Fig. 1, we see that the chilled water return temperature\nentering each chiller\u2019s evaporator is the plantwide chilled\nwater return temperature:\nTchwr,i=\u00afTchwr, i = 1, . . . , nch. (60)\nSimilarly,\nTcdws,i=\u00afTcwsi= 1, . . . , nch(61)\nTsw\nk=\u00afTchws\nk (62)\nwhere the plantwide cooling water supply temperature \u00afTcws\nis an output of the cooling water loop, and will be formally\ndefined later in (70). The flow rate of cooling water returning\nto the cooling water loop is the sum of the condenser\nwater flow rates in the chillers, and cooling water return\ntemperature \u00afTcwris a weighted average of the cooling water\n(condenser outlet) temperatures of all active chillers:\n\u02d9mcd\nk=nchX\ni=1\u02d9mcd,i\nk1ch,i\nk= \u02d9mcw\nk=nctX\nj=1\u02d9mcw,j\nk1ct,j\nk, (63)\n\u00afTcwr\nk=(1\n\u02d9mcw\nkPnct\ni=11ch,iTcdwr,i\nk\u02d9mcd,i\nk,Pnch\ni=11ch,i\u0338= 0,\nTcwr,nom\nk,Pnch\ni=11ch,i= 0.\n(64)\nNote that (63) is due to mass conservation at the intercon-\nnection between the chilled water loop and the cooling water\nloop (see Fig. 1), which will be described next.B. Cooling Water Loop\nThe cooling water loop consists of cooling towers and\ncooling water pumps; see Fig. 1. The exogenous inputs\nand states of the cooling water loop are: wcw= [Toawb],\nxcw= [xct,i]where i= 1, . . . , nct. The control inputs of the\ncooling water loop are\nucw= [ 1ct,j,\u02d9mcw,j,\u02d9moa,j], j= 1, . . . , nct. (65)\nAs in the case of the chilled water loop, it has a few additional\noutputs:\nycw= [ \u02d9mcw,\u00afTcws,\u02d9qct, Pct, Pcwp], (66)\nwhere\nTcwr,i\nk=\u00afTcwr\nk, i= 1, . . . , nct(67)\n\u02d9mcw\nk=nctX\ni=1\u02d9mcw,i\nk,\u02d9qct\nk=nctX\ni=1\u02d9qct,i\nk, (68)\nPct\nk=nctX\ni=1Pct,i\nk, Pcwp\nk=nctX\ni=1Pcwp,i\nk(69)\nwhere \u00afTcwr\nk,\u02d9qct,i\nk, Pct,i\nk, Pcwp,i\nkare defined in (64), (47), (48),\n(49), and\n\u00afTcws\nk=(1\n\u02d9mcw\nkPnct\ni=11ct,iTcws,i\nk\u02d9mcw,i\nk,Pnct\ni=11ct,i\nk\u0338= 0,\n\u00afTcwr\nk,Pnct\ni=1 1ct,i\nk= 0,\n(70)\nC. Interconnecting Water Loops to Obtain CCWP Model\nConnecting chilled water loop III-A and cooling water\nloop III-B together with state propagation equations (i.e.,\ndynamic models) of the component models completes the\ncomplete model of the CCWP. For the complete CCWP\nmodel, the plant-wide states xp, inputs up, and disturbances\nwp, along with additional outputs, are:\nxp:= [xcc, xtes, xch,i, xct,j]T\u2208R4+2nch+nct(71)\nup:= [uchw, ucw]T\u2208R3nch+3nct+3,\nwp:= [wcc, wct]T\u2208R2. (72)\nyp:= [ychw, ycw, Ptot]T\u2208R18, (73)\nAll variables are defined in Section III-A and III-B except\nthe total electric power consumption Ptot:\nPtot\nk=Pch\nk+Pct\nk+Pchwp\nk+Pcwp\nk. (74)\nTogether, (16)-(74) describe the proposed CCWP model:\nxp\nk+1=f(xp\nk, up\nk, wp\nk), yp\nk=h(xk, uk, wk) (75)\nA closed loop control system with a CCWP and a supervisory\ncontroller that decides the plant control command up\nkmay\nhave additional exogenous input than that for the plant, such\nas a forecast of electricity price.\n\n--- Page 11 ---\n11\nTABLE I\nAFEW PARAMETERS OF THE CCWP MODEL SIMULATED .\nParameter units Value Parameter units Value\nTlwr\nUBCelsius 15 Tcwr\nUB\u25e6C 40\nSLB N/A 0.05 SUB N/A 0.95\nMteskg 1.413\u00d7105Tlwr\nUB\u25e6C 15\nTapp\nLBCelsius 0 Tapp\nUB\u25e6C 40\nTran\nLBCelsius 2.2 Tran\nUB\u25e6C 22.2\n\u02d9mcd\nnom kg/s 47.44 Tchws\nUB\u25e6C 10\nTcdws\nLBCelsius 15 Tcdws\nUB\u25e6C 40\nTcdwr\nnom Celsius 35 Tcdwr\nUB\u25e6C 40\nD. Software implementation\nA Matlab implementation of the CCWP model is re-\nleased under the MIT license and is available in https:\n//gitlab.com/pbarooah/ccwp model. The chiller model (31)\nand the cooling tower model (45) are non linear programs\n(NLPs). There are many powerful open source tools for\nposing and solving NLPs efficiently. In our Matlab imple-\nmentation we use CasADi [31] and IPOPT [32] to pose\nand solve (31),(45). The user needs to download and install\nCasADi, which is freely available under LGPL-3.0 license.\nAll the parameters of the CCWP are defined in the function\nfunc_defPlantParams_2Ch2CT in the codebase.\nDuring simulation, the control inputs up\nkcan be computed\neither by a supervisory controller or specified a-priori. In\neither case, not all possible values of the input vector up\nkare\nfeasible. For instance, if a chiller is \u201con\u201d then there must be\na non-zero condenser water flow rate in that chiller, meaning\n1ch,1\nk= 1 and \u02d9mcd,1\nk= 0 are not allowed. There are several\nsuch feasibility checks that need to be done; e.g., (7),(63). A\nfunction func_CheckInputs in the codebase checks if uk\npasses these feasibility tests, and if not, stops the simulation.\nThe codebase currently has the model of a CCWP\nthat consists of an aggregate load, a TES, two dis-\ntinct chillers, two distinct cooling towers, and corre-\nsponding chilled water and cooling water pumps. The\nparameters of ElectricEIRChiller Carrier 19XR\n823kW/6.28COP/Vanes model in MBL, which has\na cooling capacity 0.823 MW, are used for Chiller 1.\nThe parameters of ElectricEIRChiller York YT\n1368kW/7.35COP/VSD model in MBL, which has a cool-\ning capacity 2.1 MW, is used for Chiller 2. Both cooling\ntowers are of YorkCalc type, but their nominal air flowrate\nand water flowrates are changed from the default to be\nconsistent with the chiller condenser flowrates. The design\ncooling capacity of the two cooling towers combined is\n2859.8 kW. The nominal power consumption of cooling\ntowers are modified according to MBL references [15]. Some\nof the parameters of the CCWP are mentioned in Table I.\nThe state propagation function func_f_CCWP_2Ch2CT\nreturns the next state xp\nk+1when provided xp\nk, up\nk, wp\nkand\nplant parameters as arguments. For simulating a CCWP\nwith a different number and type of equipment, a new state\npropagation function has to be written.IV. C LOSED LOOP SIMULATION EXAMPLE\nThe proposed model has been used for training RL con-\ntrollers for a CCWP in [33]. Due to lack of space and\nease of exposition, here we present a simpler application of\nthe model: closed-loop simulation results with a rule-based\ncontroller. The controller uses real-time electricity price to\nupdate the control command ukat every kwith a goal to\nreduce total electricity cost and meet the load \u02d9qL. We omit\nthe details of the controller due to lack of space, the interested\nreader can find them in [33].\nFig. 9 shows the three exogenous signals used in the\nsimulations: OA wet bulb temperature, electricity price (top),\nand cooling demand \u02d9qL, cooling delivered \u02d9qcc(bottom), over\na three-day period. Note that the user needs to provide these\nthree exogenous inputs in order to perform simulations with\nthe CCWP model and the rule based controller. The OA\nwet bulb temperature is obtained from is obtained from the\nNational Solar Radiation Database https://nsrdb.nrel.gov, for\nthe location for Gainesville, FL, USA. Electricity price is\ntaken from PJM [34]. The cooling load is chosen as a scaled\nversion of PJM\u2019s total electricity demand for the same period,\nsince cooling demand and electricity demand are correlated.\nThe scaling is done to make the maximum cooling load equal\nto 130% of the total cooling capacity of the two chillers\ncombined. These closed loop simulations can be recreated by\nrunning the Matlab script simulateCCWP_withRBC.m in\nthe codebase.\n0 12 24 36 48 60 72\nTime (hour)6810121416U.S. cents/kWhElec. price\nTOAWB(\u25e6C)\n2223242526\n\u25e6C\n(a)\n0 12 24 36 48 60 72\nTime (hour)1.52.02.5MW\u02d9qL\n\u02d9qcc\n(b)\nFig. 9. Closed loop simulation: All three exogenous inputs wp, and cooling\nprovided \u02d9qcc.\nWe can see from Fig. 9(b) that the plant is able to meet\nthe cooling load for most, but not all, of the time. During\n\n--- Page 12 ---\n12\n0 12 24 36 48 60 72\nTime (hour)681012141618\u25e6CTLWSTLWR\u02d9mLW\n45505560657075808590\nkg/s\nFig. 10. Closed loop simulation: Saturation of cooling coil heat exchange\nduring periods of high load.\nperiods when the cooling load exceeds cooling capacity, both\nthe water flow through the cooling coil and the temperature\nat its exit saturate to their upper bounds; see Fig. 10. Fig. 11\nshows that the various water temperatures are within bounds\nat all times; the kind of unrealistic high temperatures seen\nin Section I-A never occurs. The oscillations observed at\ncertain times is due to frequent changes in the TES flow\nrate commands computed by the rule based controller. The\ncontroller needs to be improved to make the closed loop\nresponse smoother.\n0 10 20 30 40 50 60 70\nTime (hour)10203040\u25e6CTchws\nTchwrTcws\nTcwr\nFig. 11. Closed loop simulation: Chilled water and cooling water temper-\natures.\nThe design COP of the two chillers used in the simu-\nlations are 6.28 and 7.35. The plantwide COP, computed\nas(Pkmax\nk=0\u02d9qcc\nk)/(Pkmax\nk=0Ptot\nk), turns out to be 5.84, i.e., 93-\n80% of the chillers\u2019. A plantwide COP that is between 60\n- 80% of chiller\u2019s COP is considered \u201cOK\u201d and above 80%\nis considered \u201cgood\u201d [35]. These numbers therefore give us\nconfidence on both the controller and the CCWP model.\nV. C ONCLUSIONS\nThe proposed model has been used for training an RL\ncontroller for a CCWP in [33]. There are many improvements\nthat can be made to the model and its software implementa-\ntion. As to the software, translating the codebase from Matlab\nto Python or Julia will obviate the need for commercial\nsoftware with a license fee. Improvements are possible to themathematical model itself, such as incorporating additional\ndynamic elements and transport delays.\nVerification of the proposed CCWP model against exper-\nimental data is not addressed in this paper. The accuracy\nof the proposed model is dependent on the accuracy of the\nconstituent equipment models. It was shown in [36] that\nmany existing and widely used chiller models for predicting\nCOP can work well in laboratory conditions but provide poor\npredictions in field conditions. The component models we use\nare ultimately based on existing models in the literature and\nmay suffer from similar issues. However, since the proposed\nCCWP model is modular, improved component models can\nbe incorporated in the future.\nREFERENCES\n[1] S. Huang, W. Zuo, and M. D. Sohn, \u201cImproved cooling tower\ncontrol of legacy chiller plants by optimizing the condenser\nwater set point,\u201d Building and Environment , vol. 111, pp.\n33\u201346, 2017. [Online]. Available: https://www.sciencedirect.\ncom/science/article/pii/S0360132316304036\n[2] K. Deng, Y . Sun, S. Li, Y . Lu, J. Brouwer, P. G. Mehta,\nM. Zhou, and A. Chakraborty, \u201cModel predictive control of\ncentral chiller plant with thermal energy storage via dynamic\nprogramming and mixed-integer linear programming,\u201d IEEE\nTransactions on Automation Science and Engineering , vol. 12,\nno. 2, pp. 565\u2013579, 2015.\n[3] G. Schweiger, P.-O. Larsson, F. Magnusson, P. Lauenburg,\nand S. Velut, \u201cDistrict heating and cooling systems \u2013\nframework for modelica-based simulation and dynamic\noptimization,\u201d Energy , vol. 137, pp. 566\u2013578, 2017.\n[Online]. Available: https://www.sciencedirect.com/science/\narticle/pii/S0360544217308691\n[4] N. R. Patel, M. J. Risbeck, J. B. Rawlings, C. T. Maravelias,\nM. J. Wenzel, and R. D. Turney, \u201cA case study of economic\noptimization of hvac systems based on the stanford university\ncampus airside and waterside systems,\u201d in International High\nPerformance Buildings Conference , vol. paper 253, 2018.\n[5] L. Zabala, J. Febres, R. Sterling, S. L \u00b4opez, and\nM. Keane, \u201cVirtual testbed for model predictive control\ndevelopment in district cooling systems,\u201d Renewable and\nSustainable Energy Reviews , vol. 129, p. 109920, 2020.\n[Online]. Available: https://www.sciencedirect.com/science/\narticle/pii/S1364032120302112\n[6] S. Park, K. U. Ahn, S. Hwang, S. Choi, and C. S. Park,\n\u201cMachine learning vs. hybrid machine learning model for\noptimal operation of a chiller,\u201d Science and Technology for\nthe Built Environment , vol. 25, no. 2, pp. 209\u2013220, 2019.\n[7] S. Qiu, Z. Li, Z. Li, and X. Zhang, \u201cModel-free optimal chiller\nloading method based on Q-learning,\u201d Science and Technology\nfor the Built Environment , vol. 26, no. 8, pp. 1100\u20131116, 2020.\n[8] Z. Guo, A. R. Coffman, and P. Barooah, \u201cReinforcement\nlearning for optimal control of a district cooling energy plant,\u201d\ninAmerican Control Conference (ACC) , June 2022, pp. 3329\u2013\n3334.\n[9] W. Wong, P. Dutta, O. V oicu, Y . Chervonyi, C. Paduraru, and\nJ. Luo, \u201cOptimizing industrial HV AC systems with hierarchi-\ncal reinforcement learning,\u201d arXiv:2209.08112, 2022.\n[10] C. Rosdahl, B. Bernhardsson, and B. Eisenhower, \u201cModel-free\nMIMO control tuning of a chiller process using reinforcement\nlearning,\u201d Science and Technology for the Built Environment ,\nvol. 29, no. 8, pp. 782\u2013794, 2023.\n[11] B. Mu, Y . Li, J. M. House, and T. I. Salsbury, \u201cReal-time\noptimization of a chilled water plant with parallel chillers\nbased on extremum seeking control,\u201d Applied Energy , vol. 208,\npp. 766\u2013781, 2017.\n\n--- Page 13 ---\n13\n[12] H. D. Vu, B. D. Keating, A. G. Alleyne, K. S. Chai, and\nZ. Zhang, \u201cEnergy optimization of an in-service commercial\nbuilding chiller plant via extremum seeking control,\u201d in Inter-\nnational High Performance Buildings Conference , 2018.\n[13] ASHRAE, \u201c2020 ASHRAE Handbook \u2014 HV AC Systems and\nEquipment,\u201d 2020.\n[14] D. B. Crawley, L. K. Lawrie, C. O. Pedersen, and F. C. Winkel-\nmann, \u201cEnergyPlus: Energy simulation program,\u201d ASHRAE\nJournal , vol. 42, no. 4, pp. 49\u201356, 2000.\n[15] M. Wetter, W. Zuo, T. S. Nouidui, and X. Pang,\n\u201cModelica buildings library,\u201d Journal of Building Performance\nSimulation , vol. 7, no. 4, pp. 253\u2013270, 2014. [Online].\nAvailable: https://doi.org/10.1080/19401493.2013.765506\n[16] B. P. Baillie and G. M. Bollas, \u201cDevelopment, validation,\nand assessment of a high fidelity chilled water plant model,\u201d\nApplied Thermal Engineering , vol. 111, pp. 477\u2013488, 2017.\n[17] R. Jaramillo, \u201cA multi-agent control approach for optimization\nof central cooling plants,\u201d Ph.D. dissertation, Purdue Univer-\nsity, 2018.\n[18] C. Fan, K. Hinkelman, Y . Fu, W. Zuo, S. Huang, C. Shi,\nN. Mamaghani, C. Faulkner, and X. Zhou, \u201cOpen-source\nmodelica models for the control performance simulation of\nchiller plants with water-side economizer,\u201d Applied Energy ,\nvol. 299, p. 117337, 2021.\n[19] L. B. N. Lab and P. N. N. Lab, \u201cOpenbuildingcontrol,\u201d\naccessed on Jun.03.2022. [Online]. Available: https://www.\nenergy.gov/eere/buildings/openbuildingcontrol\n[20] M. W. (LBNL) and C. van Treeck (RWTH Aachen), \u201cIbpsa\nproject 1,\u201d accessed on Jun.03.2022. [Online]. Available:\nhttps://ibpsa.github.io/project1/index.html\n[21] U.S. Dept. of Energy, EnergyPlus Engineering Reference .\nUS DEPARTMENT OF ENERGY, 2022, version 22.2.0.\n[Online]. Available: https://energyplus.net/documentation\n[22] J. C. Hensley, Cooling tower fundamentals . Marley Cooling\nTower Company Stockton, CA, 1985.\n[23] Z. Liu, H. Tan, D. Luo, G. Yu, J. Li, and Z. Li,\n\u201cOptimal chiller sequencing control in an office building\nconsidering the variation of chiller maximum cooling\ncapacity,\u201d Energy and Buildings , vol. 140, pp. 430\u2013442, 2017.\n[Online]. Available: https://www.sciencedirect.com/science/\narticle/pii/S0378778816309495\n[24] Z. Guo, A. Chaudhari, A. R. Coffman, and P. Barooah, \u201cOpti-\nmal control of district cooling energy plant with reinforcement\nlearning and model predictive control,\u201d ASME Journal of\nEngineering for Sustainable Buildings and Cities , vol. 5, p. 12,\nFebruary 2024.\n[25] N. S. Raman, K. Devaprasad, B. Chen, H. A. Ingley, and\nP. Barooah, \u201cModel predictive control for energy-efficient\nHV AC operation with humidity and latent heat considerations,\u201d\nApplied Energy , vol. 279, p. 115765, December 2020.\n[26] American Society of Heating Refrigerating and Air Condi-\ntioning Engineers, Standard 90.1-2022-Energy Standard for\nSites and Buildings Except Low-Rise Residential Buildings .\nAtlanta, GA: ASHRAE, 2022.\n[27] J. Glazer, ASHRAE Design Guide for Cool Thermal Storage\n(2nd Edition) . American Society of Heating, Refrigerating\nand Air-Conditioning Engineers, Inc., 2019.\n[28] M. J. Risbeck, C. T. Maravelias, J. B. Rawlings, and R. D.\nTurney, \u201cA mixed-integer linear programming model for real-\ntime cost optimization of building heating, ventilation, and air\nconditioning equipment,\u201d Energy and Buildings , vol. 142, pp.\n220\u2013235, 2017.\n[29] ASHRAE, \u201cThe ASHRAE handbook fundamentals (SI Edi-\ntion),\u201d 2016.\n[30] \u2014\u2014, ASHRAE Handbook- HVAC applications . American\nSociety of Heating, Refrigerating and Air-Conditioning Engi-\nneers, Inc., 2019.\n[31] J. A. E. Andersson, J. Gillis, G. Horn, J. B. Rawlings, andM. Diehl, \u201cCasADi: a software framework for nonlinear op-\ntimization and optimal control,\u201d Mathematical Programming\nComputation , vol. 11, no. 1, pp. 1\u201336, Mar 2019.\n[32] A. W \u00a8achter and L. T. Biegler, \u201cOn the implementation of\nan interior-point filter line-search algorithm for large-scale\nnonlinear programming,\u201d Mathematical Programming , vol.\n106, no. 1, pp. 25\u201357, Mar 2006.\n[33] Z. Guo, \u201cReinforcement learning for optimal control of dis-\ntrict cooling energy plant,\u201d Ph.D. dissertation, University Of\nFlorida, December 2023.\n[34] PJM data miner, \u201cPJM Interconnection Real-Time Hourly\nLMPs,\u201d https://www.pjm.com/markets-and-operations/etools/\ndata-miner-2, 2022, [Online, accessed 2022-10-02].\n[35] David Brooks (PE, CxA, Principal System Engineer at Akin\nBrooks Engineering), personal communication, 2023.\n[36] B. Zhang, S. You, S. Wang, X. Ding, C. Wang, and Y . Gao,\n\u201cFrom laboratory to on-site operation: Reevaluation of em-\npirically based electric water chiller models,\u201d in Building\nSimulation , vol. 15, no. 2. Springer, 2022, pp. 213\u2013232.",
  "project_dir": "artifacts/projects/enhanced_cs.SY_2508.15649v1_A_Central_Chilled_Water_Plant_Model_for_Designing_",
  "communication_dir": "artifacts/projects/enhanced_cs.SY_2508.15649v1_A_Central_Chilled_Water_Plant_Model_for_Designing_/.agent_comm",
  "assigned_at": "2025-08-22T21:12:54.236518",
  "status": "assigned"
}